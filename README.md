
# Что такое Interlayer transactions?

Межуровневые транзакции позволяют предотвратить появляение аномальных данных в хранилище при возникновении ошибки в ходе выполнения сценария.


## Клонирование репозитория
```
$ git clone https://github.com/kurerid/interlayer-transactions.git
```
## Проблема ❌

Как сценарий для примера работы рассмотрим регистрацию пользователя.

На сервер приходит запрос и начинается сценарий регистрации в ходе которого нужно:

- нужно убедиться, что пользователь с такими данными не был зарегестрирорван;
- сохранить в базе новую запись о пользователе;
- ...
- отправить на указанный email письмо для подтверждения регистрации.

Допустим на последнем шаге, при отправке письма для подверждения регистрации в сервисе, случилась ошибка.
Связь с сервером отправки сообщений могла оборваться.
Тогда все предыдущие шаги сценария нужно отменить, чтобы в базе не осталась запись о пользователе, чья регистрация не была доведена до своего бизнес-логического конца.

## Решение ✔️

Для решения данной проблемы были придуманы межуровневые транзакции.

Они позволяют с помощью одной транзакции выполнять несколько usecase-действий, которые отправляют запросы к базе данных.
И даже если ошибка возникнет в ходе выполнения иных вызовов функций, не задействованных во взаимодействии с базой, то эту транзакцию так же можно будет отменить.
